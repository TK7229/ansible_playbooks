-
  name: Ontap REST API
  hosts: localhost
  gather_facts: False
  collections:
    - netapp.ontap
  vars:
    login: &login
      #hostname: 192.168.20.140
      hostname: 192.168.77.140
      username: {{ ansible_env.netapp_username }}
      state: present
      password: {{ ansible_env.netapp_password }}
      #hostname: "{{ admin_ip }}"
      #username: "{{ admin_username }}"
      #password: "{{ admin_password }}"
      https: true
      validate_certs: false
    svm_login: &svm_login
      hostname: "{{ svm_admin_ip }}"
      username: "{{ svm_admin_username }}"
      password: "{{ svm_admin_password }}"
      https: true
      validate_certs: false

  tasks:   
   - name: Create FlexVol
     na_ontap_volume:
        state: present
        use_rest: always
        <<: *login
        name: testflexvol1
        is_infinite: False
        aggregate_name: aggr0_data
        size: 30
        size_unit: mb
        type: rw
        user_id: 1001
        group_id: 2002
        tiering_policy: auto
        export_policy: default
        percent_snapshot_space: 60
        #qos_policy_group: max_performance_gold
        vserver: cifs
        wait_for_completion: True
        #space_slo: none
        #nvfail_enabled: False
        comment: ansible created volume
        
   - name: Create FlexVol
     na_ontap_volume:
        state: present
        use_rest: always
        <<: *login
        name: testflexvol2
        is_infinite: False
        aggregate_name: aggr0_data
        size: 30
        size_unit: mb
        type: rw
        user_id: 1001
        group_id: 2002
        tiering_policy: auto
        export_policy: default
        percent_snapshot_space: 60
        #qos_policy_group: max_performance_gold
        vserver: cifs
        wait_for_completion: True
        #space_slo: none
        #nvfail_enabled: False
        comment: ansible created volume
        
   - name: Create FlexVol
     na_ontap_volume:
        state: present
        use_rest: always
        <<: *login
        name: testflexvol3
        is_infinite: False
        aggregate_name: aggr0_data
        size: 30
        size_unit: mb
        type: rw
        user_id: 1001
        group_id: 2002
        tiering_policy: auto
        export_policy: default
        percent_snapshot_space: 60
        #qos_policy_group: max_performance_gold
        vserver: cifs
        wait_for_completion: True
        #space_slo: none
        #nvfail_enabled: False
        comment: ansible created volume
